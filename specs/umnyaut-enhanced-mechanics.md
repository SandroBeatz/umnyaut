# Улучшенная механика онбординга и прогрессии - Умняут

## Оглавление
1. [Обновленный онбординг](#обновленный-онбординг)
2. [Адаптация по возрасту](#адаптация-по-возрасту)
3. [Система категорий и прогресса](#система-категорий-и-прогресса)
4. [Структуры данных](#структуры-данных)
5. [Пользовательский интерфейс](#пользовательский-интерфейс)
6. [API изменения](#api-изменения)

---

## Обновленный онбординг

### Концепция

Вместо запроса настроек при каждой игре, собираем ключевую информацию один раз при первом визите:
- **Имя** - для персонализации
- **Возраст** - для адаптации контента
- **Предпочитаемая сложность** - применяется по умолчанию ко всем играм

### Экран онбординга

```
┌─────────────────────────────────────────┐
│                                         │
│   👋 Добро пожаловать в Умняут!        │
│                                         │
│   Расскажи немного о себе              │
│                                         │
│   📝 Как тебя зовут?                   │
│   [_____________]                       │
│                                         │
│   🎂 Сколько тебе лет?                 │
│   [▼ Выбери возрастную группу]         │
│   • До 12 лет                          │
│   • 13-17 лет                          │
│   • 18-25 лет                          │
│   • 26-40 лет                          │
│   • 41-60 лет                          │
│   • 60+ лет                            │
│                                         │
│   🎯 Какой уровень предпочитаешь?     │
│   [🟢 Легкий] [🟡 Средний] [🔴 Сложный]│
│                                         │
│   💡 Можно изменить в любой момент     │
│      в настройках                       │
│                                         │
│   [Продолжить без регистрации]         │
│   [Войти через Google]                 │
│                                         │
└─────────────────────────────────────────┘
```

### Преимущества подхода

✅ **Один раз настроил - всегда работает**
- Не нужно каждый раз выбирать сложность
- Система автоматически подстраивается под пользователя

✅ **Персонализация с первой секунды**
- Контент адаптирован под возраст
- Словарь соответствует возрастной группе
- Размеры сеток оптимизированы

✅ **Гибкость**
- Можно изменить в настройках в любой момент
- Можно переопределить для конкретной игры
- Система предложит сохранить новую сложность как дефолтную

---

## Адаптация по возрасту

### Возрастные группы

```typescript
const AGE_GROUPS = {
  'kids': { 
    min: 0, 
    max: 12, 
    label: 'До 12 лет',
    description: 'Простой словарь, небольшие сетки'
  },
  'teens': { 
    min: 13, 
    max: 17, 
    label: '13-17 лет',
    description: 'Школьная программа, современные темы'
  },
  'young': { 
    min: 18, 
    max: 25, 
    label: '18-25 лет',
    description: 'Полный словарь, актуальный контент'
  },
  'adult': { 
    min: 26, 
    max: 40, 
    label: '26-40 лет',
    description: 'Академический уровень, широкий кругозор'
  },
  'mature': { 
    min: 41, 
    max: 60, 
    label: '41-60 лет',
    description: 'Классический подход, разнообразие тем'
  },
  'senior': { 
    min: 61, 
    max: 120, 
    label: '60+ лет',
    description: 'Крупный шрифт, классические темы'
  }
};
```

---

### Адаптация контента для кроссвордов

#### 1. Дети (до 12 лет)

**Размеры сеток:**
- 🟢 Легкий: 4x4
- 🟡 Средний: 5x5
- 🔴 Сложный: 6x6

**Категории:**
- 🐾 Животные
- 🌈 Цвета и формы
- 🍎 Еда
- ⚽ Простой спорт
- 🚗 Транспорт
- 🎨 Творчество

**Особенности:**
- Максимальная длина слова: 6 букв
- Простые, короткие вопросы
- Подсказки всегда доступны
- Поощрительные сообщения

---

#### 2. Подростки (13-17 лет)

**Размеры сеток:**
- 🟢 Легкий: 5x5
- 🟡 Средний: 7x7
- 🔴 Сложный: 9x9

**Категории:**
- 🎮 Игры и технологии
- 🎬 Кино и сериалы
- 🎵 Музыка
- ⚽ Спорт
- 🧬 Наука (школьная программа)
- 🌍 География
- 📚 Литература
- 🎨 Искусство

**Особенности:**
- Максимальная длина слова: 10 букв
- Современный, интересный стиль вопросов
- Актуальные темы и примеры
- Элементы поп-культуры

---

#### 3. Молодежь (18-25 лет)

**Размеры сеток:**
- 🟢 Легкий: 5x5
- 🟡 Средний: 7x7
- 🔴 Сложный: 10x10

**Категории:**
- 🧬 Наука
- 🎭 Искусство
- 📜 История
- 🌍 География
- 💼 Экономика и бизнес
- 🎬 Кино и культура
- 💻 Технологии
- 🍷 Кулинария
- ⚽ Спорт
- 🎵 Музыка

**Особенности:**
- Максимальная длина слова: 12 букв
- Полный словарь
- Актуальные темы
- Междисциплинарные вопросы

---

#### 4. Взрослые (26-40 лет)

**Размеры сеток:**
- 🟢 Легкий: 5x5
- 🟡 Средний: 7x7
- 🔴 Сложный: 10x10

**Категории:**
- 🧬 Наука
- 🎭 Искусство
- 📜 История
- 🌍 География
- 💼 Экономика и бизнес
- 🎬 Кино и культура
- ⚖️ Право
- 🏛️ Политика
- 💻 Технологии
- 🍷 Кулинария
- ⚽ Спорт
- 🎵 Музыка

**Особенности:**
- Максимальная длина слова: 12 букв
- Академический стиль
- Профессиональная терминология
- Сложные междисциплинарные связи

---

#### 5. Зрелые (41-60 лет)

**Размеры сеток:**
- 🟢 Легкий: 5x5
- 🟡 Средний: 7x7
- 🔴 Сложный: 10x10

**Категории:**
- 🧬 Наука
- 🎭 Искусство
- 📜 История
- 🌍 География
- 💼 Экономика и бизнес
- 🎬 Кино и культура
- ⚖️ Право
- 🏛️ Политика
- 💻 Технологии
- 🍷 Кулинария
- ⚽ Спорт
- 🎵 Музыка
- 🌿 Природа и садоводство

**Особенности:**
- Классический подход
- Проверенные источники
- Широкий кругозор
- Баланс между классикой и современностью

---

#### 6. Пожилые (60+ лет)

**Размеры сеток:**
- 🟢 Легкий: 5x5
- 🟡 Средний: 6x6
- 🔴 Сложный: 8x8

**Категории (базовые + дополнительные):**

**Базовые категории (как у других групп):**
- 🧬 Наука
- 🎭 Искусство
- 📜 История
- 🌍 География
- 🎬 Кино и культура
- ⚽ Спорт
- 🎵 Музыка
- 🍷 Кулинария
- 🌿 Природа и садоводство

**Дополнительные категории:**
- 📺 Советское кино и телевидение
- 📖 Классическая литература
- 🎼 Классическая музыка и эстрада
- 🏛️ История СССР/России
- 🌾 Садоводство и огородничество
- 🎨 Живопись и скульптура

**Особенности:**
- Увеличенный шрифт в интерфейсе
- Классический, ностальгический стиль
- Подсказки легко доступны
- Более плавная кривая сложности
- Акцент на проверенную классику

---

## Система категорий и прогресса

### Архитектура

Прогресс отслеживается на **трех уровнях**:

1. **Глобальный прогресс** - общий по всей платформе
2. **Прогресс по типам игр** - отдельно для кроссвордов, судоку и т.д.
3. **Прогресс по категориям** - внутри каждого типа игры

### Многоуровневая система

```
Глобальный прогресс (вся платформа)
│
├─ Кроссворды (прогресс по игре)
│  ├─ 🧬 Наука (67/100)
│  ├─ 🎭 Искусство (23/100)
│  └─ 🌍 География (0/100)
│
├─ Судоку (прогресс по игре)
│  ├─ 🔢 Классическое (4/200)
│  └─ 🎯 Диагональное (0/200)
│
└─ Анаграммы (прогресс по игре)
   ├─ 📚 Литература (0/150)
   └─ 🎬 Кино (0/150)
```

### Категории по играм

**Важно:** У каждой игры свои категории и свой прогресс!

#### Кроссворды
- 🧬 Наука (100 уникальных слов)
- 🎭 Искусство (100 слов)
- 📜 История (100 слов)
- 🌍 География (100 слов)
- 💼 Экономика (100 слов)
- 🎬 Кино (100 слов)
- И т.д.

#### Судоку (пример будущей игры)
- 🔢 Классическое (200 головоломок)
- 🎯 Диагональное (200 головоломок)
- 🔷 Неправильные формы (200 головоломок)

#### Анаграммы (пример будущей игры)
- 📚 Литература (150 анаграмм)
- 🎬 Кино (150 анаграмм)
- 🌍 Города (150 анаграмм)

---

## Структуры данных

### Профиль пользователя

```typescript
interface UserProfile {
  id: string;
  name: string;
  ageGroup: 'kids' | 'teens' | 'young' | 'adult' | 'mature' | 'senior';
  defaultDifficulty: 'easy' | 'medium' | 'hard';
  avatar?: string;
  createdAt: string;
  preferences: {
    soundEnabled: boolean;
    notificationsEnabled: boolean;
  };
}
```

### Глобальный прогресс

```typescript
interface UserProgress {
  // ОБЩАЯ СТАТИСТИКА (суммарная по всем играм)
  global: {
    totalPoints: number;        // Всего очков со всех игр
    totalGamesPlayed: number;   // Всего игр сыграно
    totalTimeSpent: number;     // Всего времени (секунды)
    level: number;              // Общий уровень платформы
    streak: number;             // Ударный режим (дни подряд)
    achievements: Achievement[]; // Глобальные достижения
  };
  
  // ПРОГРЕСС ПО ТИПАМ ИГР
  byGameType: {
    crossword: GameTypeProgress;
    sudoku: GameTypeProgress;
    anagram: GameTypeProgress;
    // ... другие игры
  };
  
  // ПРОГРЕСС ПО КАТЕГОРИЯМ (все категории всех игр)
  byCategory: CategoryProgress[];
}
```

### Прогресс по типу игры

```typescript
interface GameTypeProgress {
  gameType: string;           // 'crossword', 'sudoku', etc.
  totalGamesPlayed: number;   // Игр сыграно в этой игре
  totalPoints: number;        // Очков заработано в этой игре
  averageTime: number;        // Среднее время решения
  accuracy: number;           // Точность (0-100%)
  bestScore: number;          // Лучший результат
  level: number;              // Уровень внутри этой игры
  
  // Статистика по сложности
  byDifficulty: {
    easy: DifficultyStats;
    medium: DifficultyStats;
    hard: DifficultyStats;
  };
}

interface DifficultyStats {
  gamesPlayed: number;
  wins: number;
  averageTime: number;
  averageScore: number;
}
```

### Прогресс по категории

```typescript
interface CategoryProgress {
  categoryId: string;     // 'crossword-science'
  gameType: string;       // 'crossword'
  name: string;           // 'Наука'
  
  // Для кроссвордов - отслеживаем слова
  wordsCompleted?: number;
  totalWords?: number;
  
  // Для других игр - головоломки/задачи
  puzzlesCompleted?: number;
  totalPuzzles?: number;
  
  // Общий прогресс 0-100%
  progress: number;
  
  // Статистика
  gamesPlayed: number;
  averageScore: number;
  lastPlayedAt: string;
  
  // Достижения в категории
  milestones: {
    '25': boolean;  // 25% завершено
    '50': boolean;
    '75': boolean;
    '100': boolean;
  };
}
```

### Пример полных данных

```typescript
const exampleUserProgress = {
  global: {
    totalPoints: 5280,
    totalGamesPlayed: 24,
    totalTimeSpent: 7200,
    level: 5,
    streak: 12,
    achievements: ['first_game', 'week_streak', 'category_master']
  },
  
  byGameType: {
    crossword: {
      gameType: 'crossword',
      totalGamesPlayed: 20,
      totalPoints: 4500,
      averageTime: 720,
      accuracy: 92,
      bestScore: 450,
      level: 4,
      byDifficulty: {
        easy: { 
          gamesPlayed: 5, 
          wins: 5, 
          averageTime: 480, 
          averageScore: 180 
        },
        medium: { 
          gamesPlayed: 12, 
          wins: 11, 
          averageTime: 720, 
          averageScore: 250 
        },
        hard: { 
          gamesPlayed: 3, 
          wins: 2, 
          averageTime: 1200, 
          averageScore: 320 
        }
      }
    },
    
    sudoku: {
      gameType: 'sudoku',
      totalGamesPlayed: 4,
      totalPoints: 780,
      averageTime: 900,
      accuracy: 88,
      bestScore: 250,
      level: 1,
      byDifficulty: {
        easy: { 
          gamesPlayed: 4, 
          wins: 3, 
          averageTime: 900, 
          averageScore: 195 
        }
      }
    }
  },
  
  byCategory: [
    {
      categoryId: 'crossword-science',
      gameType: 'crossword',
      name: 'Наука',
      wordsCompleted: 67,
      totalWords: 100,
      progress: 67,
      gamesPlayed: 12,
      averageScore: 245,
      lastPlayedAt: '2026-02-06T14:30:00Z',
      milestones: {
        '25': true,
        '50': true,
        '75': false,
        '100': false
      }
    },
    {
      categoryId: 'crossword-art',
      gameType: 'crossword',
      name: 'Искусство',
      wordsCompleted: 23,
      totalWords: 100,
      progress: 23,
      gamesPlayed: 5,
      averageScore: 230,
      lastPlayedAt: '2026-02-05T10:15:00Z',
      milestones: {
        '25': false,
        '50': false,
        '75': false,
        '100': false
      }
    },
    {
      categoryId: 'sudoku-classic',
      gameType: 'sudoku',
      name: 'Классическое',
      puzzlesCompleted: 4,
      totalPuzzles: 200,
      progress: 2,
      gamesPlayed: 4,
      averageScore: 195,
      lastPlayedAt: '2026-02-04T18:20:00Z',
      milestones: {
        '25': false,
        '50': false,
        '75': false,
        '100': false
      }
    }
  ]
};
```

---

## Пользовательский интерфейс

### Dashboard - главная панель

```
┌─────────────────────────────────────────────────────────┐
│ [Sidebar]  │  Привет, Алексей (26 лет)! 👋             │
│            │                                            │
│ 🏠 Главная │  🔥 Ударный режим: 12 дней                │
│ 🎮 Игры    │  ⭐ Очки: 5,280 • Уровень 5               │
│ ⚙️ Настр-  │  🎯 Сложность: Средний                    │
│   ойки     │                                            │
│            │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│ 👤 Алексей │                                            │
│            │  📊 ОБЩАЯ СТАТИСТИКА                      │
│            │  ┌────────┐ ┌────────┐ ┌────────┐        │
│            │  │5,280   │ │24 игры │ │2 часа  │        │
│            │  │Очков   │ │Сыграно │ │Всего   │        │
│            │  └────────┘ └────────┘ └────────┘        │
│            │                                            │
│            │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│            │                                            │
│            │  🎯 КРОССВОРД                             │
│            │  Уровень: 4 • Игр: 20 • Очков: 4,500     │
│            │  [🎮 Играть]  [📊 Статистика]            │
│            │                                            │
│            │  Активные категории:                      │
│            │  ┌─────────────────────────────┐         │
│            │  │ 🧬 Наука • 12 игр           │         │
│            │  │ ██████████████░░ 67/100     │         │
│            │  │ [Продолжить] →              │         │
│            │  └─────────────────────────────┘         │
│            │  ┌─────────────────────────────┐         │
│            │  │ 🎭 Искусство • 5 игр        │         │
│            │  │ █████░░░░░░░░░░ 23/100      │         │
│            │  │ [Продолжить] →              │         │
│            │  └─────────────────────────────┘         │
│            │  [+ Добавить категорию]                   │
│            │                                            │
│            │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│            │                                            │
│            │  🔢 СУДОКУ                                │
│            │  Уровень: 1 • Игр: 4 • Очков: 780        │
│            │  [🎮 Играть]  [📊 Статистика]            │
│            │                                            │
│            │  ┌─────────────────────────────┐         │
│            │  │ 🔢 Классическое • 4 игры    │         │
│            │  │ ██░░░░░░░░░░░░ 4/200        │         │
│            │  │ [Продолжить] →              │         │
│            │  └─────────────────────────────┘         │
│            │                                            │
└─────────────────────────────────────────────────────────┘
```

---

### Выбор категории при игре

**При клике "🎮 Играть" (Кроссворд):**

```
┌─────────────────────────────────────────┐
│   🎯 Выбери категорию                  │
│                                         │
│   🔥 Продолжить                        │
│   ┌─────────────────────────────┐     │
│   │ 🧬 Наука (67/100)           │     │
│   │ Последняя игра: вчера       │     │
│   │ [Играть →]                  │     │
│   └─────────────────────────────┘     │
│                                         │
│   🆕 Другие категории                  │
│   ┌───────────┐  ┌───────────┐        │
│   │🎭 Искусство│  │🌍 География│       │
│   │(23/100)   │  │(0/100)    │        │
│   │[Играть]   │  │[Играть]   │        │
│   └───────────┘  └───────────┘        │
│                                         │
│   [Все категории →]                    │
│                                         │
│   ⚙️ Сложность: Средний [Изменить]    │
│                                         │
└─────────────────────────────────────────┘
```

**Если кликает "Изменить":**
- Быстрый селектор сложности
- Применяется ТОЛЬКО к текущей игре
- После игры: "Сохранить Сложный как новый уровень по умолчанию?"

---

### Настройки

```
┌─────────────────────────────────────────┐
│   ⚙️ НАСТРОЙКИ                         │
│                                         │
│   👤 ПРОФИЛЬ                           │
│   ┌─────────────────────────────┐     │
│   │ Имя: [Алексей_______]       │     │
│   │ Возраст: [26-40 лет ▼]      │     │
│   │                              │     │
│   │ 💡 Изменение возраста может │     │
│   │    повлиять на категории и  │     │
│   │    сложность слов            │     │
│   └─────────────────────────────┘     │
│                                         │
│   🎯 ИГРОВЫЕ НАСТРОЙКИ                 │
│   ┌─────────────────────────────┐     │
│   │ Сложность по умолчанию:     │     │
│   │ [🟢 Легкий] [🟡 Средний]    │     │
│   │ [🔴 Сложный]                │     │
│   │                              │     │
│   │ ☑️ Звуковые эффекты          │     │
│   │ ☑️ Вибрация (мобильные)      │     │
│   │ ☑️ Автосохранение            │     │
│   └─────────────────────────────┘     │
│                                         │
│   🎮 КРОССВОРДЫ                        │
│   ┌─────────────────────────────┐     │
│   │ Активные категории (2/5):   │     │
│   │                              │     │
│   │ • 🧬 Наука [×]              │     │
│   │ • 🎭 Искусство [×]          │     │
│   │                              │     │
│   │ [+ Управление категориями]  │     │
│   │                              │     │
│   │ Подсказки:                   │     │
│   │ ☑️ Показывать кнопки         │     │
│   │ ☑️ Предупреждать о штрафах   │     │
│   └─────────────────────────────┘     │
│                                         │
│   🔔 УВЕДОМЛЕНИЯ                       │
│   ┌─────────────────────────────┐     │
│   │ ☑️ Напоминать о серии        │     │
│   │    Время: [19:00 ▼]         │     │
│   │                              │     │
│   │ ☑️ Новые достижения          │     │
│   │ ☑️ Еженедельные отчеты       │     │
│   └─────────────────────────────┘     │
│                                         │
└─────────────────────────────────────────┘
```

---

### Детальная статистика по игре

**Модальное окно "Статистика кроссвордов":**

```
┌─────────────────────────────────────────────────────────┐
│  🎯 СТАТИСТИКА КРОССВОРДОВ                             │
│                                                         │
│  Уровень: 4 (780 XP до уровня 5)                       │
│  ████████████░░░░░░░░ 78%                              │
│                                                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                         │
│  📈 ОБЩЕЕ                                              │
│  ┌─────────────┬─────────────┬─────────────┐          │
│  │ Игр сыграно │ Всего очков │ Точность    │          │
│  │     20      │    4,500    │    92%      │          │
│  └─────────────┴─────────────┴─────────────┘          │
│                                                         │
│  🎯 ПО СЛОЖНОСТИ                                       │
│  ┌──────────────────────────────────────────┐          │
│  │ 🟢 Легкий                                │          │
│  │ Игр: 5 • Побед: 5 • Ср.время: 8:00      │          │
│  │ Ср.очки: 180 • Лучший: 210               │          │
│  └──────────────────────────────────────────┘          │
│  ┌──────────────────────────────────────────┐          │
│  │ 🟡 Средний (текущий)                     │          │
│  │ Игр: 12 • Побед: 11 • Ср.время: 12:00   │          │
│  │ Ср.очки: 250 • Лучший: 340               │          │
│  └──────────────────────────────────────────┘          │
│  ┌──────────────────────────────────────────┐          │
│  │ 🔴 Сложный                               │          │
│  │ Игр: 3 • Побед: 2 • Ср.время: 20:00     │          │
│  │ Ср.очки: 320 • Лучший: 420               │          │
│  └──────────────────────────────────────────┘          │
│                                                         │
│  📚 ПО КАТЕГОРИЯМ                                      │
│  ┌──────────────────────────────────────────┐          │
│  │ 🧬 Наука - 67/100                        │          │
│  │ ██████████████░░░░░░ 67%                 │          │
│  │ Игр: 12 • Ср.очки: 245                   │          │
│  └──────────────────────────────────────────┘          │
│  ┌──────────────────────────────────────────┐          │
│  │ 🎭 Искусство - 23/100                    │          │
│  │ █████░░░░░░░░░░░░░░░ 23%                 │          │
│  │ Игр: 5 • Ср.очки: 230                    │          │
│  └──────────────────────────────────────────┘          │
│                                                         │
│  [Закрыть]                                             │
└─────────────────────────────────────────────────────────┘
```

---

## API изменения

### Обновленный endpoint генерации кроссворда

**Request:**
```http
POST /api/crossword/generate

Content-Type: application/json
```

**Body:**
```json
{
  "difficulty": "medium",
  "category": "science",
  "ageGroup": "adult",
  "excludeIds": [1, 5, 8],
  "userProgress": {
    "wordsInCategory": 67,
    "recentWords": ["КЛЕТКА", "МИТОЗ", "ГЕНЕТИКА"]
  }
}
```

**Response:**
```json
{
  "id": "uuid-12345",
  "grid": [
    ["М", "И", "Т", "О", "З"],
    ["", "", "К", "", ""],
    ["Г", "Е", "Н", "", ""],
    ["", "", "", "", ""],
    ["", "", "", "", ""]
  ],
  "questions": {
    "across": [
      {
        "number": 1,
        "question": "Процесс деления клетки",
        "answer": "МИТОЗ",
        "length": 5,
        "hints": {
          "easy": "Происходит в ядре клетки...",
          "letters": ["М", "И", "Т", "О", "З"]
        }
      }
    ],
    "down": [
      {
        "number": 2,
        "question": "Единица наследственности",
        "answer": "ГЕН",
        "length": 3,
        "hints": {
          "easy": "Находится в ДНК...",
          "letters": ["Г", "Е", "Н"]
        }
      }
    ]
  },
  "answers": {
    "1-across": "МИТОЗ",
    "2-down": "ГЕН"
  },
  "difficulty": "medium",
  "category": "science",
  "ageAdapted": true,
  "newWordsCount": 7,
  "metadata": {
    "avgWordLength": 6.5,
    "vocabularyLevel": "adult",
    "gridSize": "7x7"
  }
}
```

---

### Endpoint получения категорий

**Request:**
```http
GET /api/crossword/categories?ageGroup=adult

Content-Type: application/json
```

**Response:**
```json
{
  "categories": [
    {
      "id": "science",
      "name": "Наука",
      "icon": "🧬",
      "description": "Биология, химия, физика",
      "totalWords": 100,
      "ageGroups": ["teens", "young", "adult", "mature", "senior"],
      "available": true
    },
    {
      "id": "art",
      "name": "Искусство",
      "icon": "🎭",
      "description": "Живопись, музыка, театр",
      "totalWords": 100,
      "ageGroups": ["teens", "young", "adult", "mature", "senior"],
      "available": true
    },
    {
      "id": "history",
      "name": "История",
      "icon": "📜",
      "description": "События, даты, личности",
      "totalWords": 100,
      "ageGroups": ["teens", "young", "adult", "mature", "senior"],
      "available": true
    }
  ]
}
```

---

### Endpoint валидации ответа

**Request:**
```http
POST /api/crossword/validate

Content-Type: application/json
```

**Body:**
```json
{
  "crosswordId": "uuid-12345",
  "answers": {
    "1-across": "МИТОЗ",
    "2-down": "ГЕН"
  },
  "timeSpent": 720,
  "hintsUsed": 1,
  "difficulty": "medium"
}
```

**Response:**
```json
{
  "correct": true,
  "mistakes": [],
  "score": 250,
  "breakdown": {
    "baseScore": 280,
    "speedBonus": 20,
    "hintPenalty": -28,
    "accuracyBonus": 30
  },
  "newWords": [
    "МИТОЗ",
    "ГЕН",
    "КЛЕТКА",
    "МОЛЕКУЛА",
    "АТОМ",
    "ЯДРО",
    "ПРОТОН"
  ],
  "categoryProgress": {
    "categoryId": "science",
    "wordsCompleted": 74,
    "totalWords": 100,
    "progress": 74
  }
}
```

---

## LocalStorage структура

### Ключи хранения

```typescript
const STORAGE_KEYS = {
  USER_PROFILE: 'umnyaut_user_profile',
  USER_PROGRESS: 'umnyaut_user_progress',
  GAME_HISTORY: 'umnyaut_game_history',
  SOLVED_ITEMS: 'umnyaut_solved_items',
  CURRENT_GAME: 'umnyaut_current_game_state',
  SETTINGS: 'umnyaut_settings'
};
```

### Решенные элементы (предотвращение дубликатов)

```typescript
interface SolvedItems {
  crossword: string[];  // ID решенных кроссвордов
  sudoku: string[];     // ID решенных судоку
  anagram: string[];    // ID решенных анаграмм
  // ... другие игры
}

// Пример
{
  crossword: [
    "crossword-science-001",
    "crossword-science-005",
    "crossword-art-003"
  ],
  sudoku: [
    "sudoku-classic-012",
    "sudoku-classic-045"
  ]
}
```

---

## Система уровней

### Глобальный уровень

**Формула:**
```typescript
function calculateGlobalLevel(progress: UserProgress): number {
  const { totalPoints, totalGamesPlayed, streak } = progress.global;
  
  // Вес разных метрик
  const pointsWeight = totalPoints * 1.0;
  const gamesWeight = totalGamesPlayed * 50;
  const streakWeight = streak * 100;
  
  const totalXP = pointsWeight + gamesWeight + streakWeight;
  
  // Уровень = sqrt(XP / 1000) + 1
  const level = Math.floor(Math.sqrt(totalXP / 1000)) + 1;
  
  return Math.min(level, 100); // Максимум 100
}
```

**Награды:**
```typescript
const GLOBAL_LEVEL_REWARDS = {
  5: 'Новый аватар',
  10: 'Премиум категория',
  15: 'Заморозка серии x1',
  20: 'Кастомная сложность',
  25: 'Таблица лидеров',
  30: 'Эксклюзивная тема',
  // ...
};
```

---

### Уровни внутри игр

**Формула для игрового уровня:**
```typescript
function calculateGameTypeLevel(gameProgress: GameTypeProgress): number {
  const { totalPoints, totalGamesPlayed, accuracy } = gameProgress;
  
  const pointsWeight = totalPoints * 1.0;
  const gamesWeight = totalGamesPlayed * 30;
  const accuracyBonus = accuracy * 10;
  
  const gameXP = pointsWeight + gamesWeight + accuracyBonus;
  
  const level = Math.floor(Math.sqrt(gameXP / 500)) + 1;
  
  return Math.min(level, 50); // Максимум 50
}
```

---

## Ключевые преимущества системы

### ✅ Персонализация
- Контент адаптирован под возраст с первой секунды
- Словарь и сложность соответствуют пользователю
- Автоматическая настройка интерфейса

### ✅ Удобство
- Настроил один раз - работает всегда
- Не нужно выбирать сложность при каждой игре
- Быстрый доступ к любимым категориям

### ✅ Мотивация
- Прогресс виден на трех уровнях
- Достижения и вехи
- Ударный режим поддерживает вовлеченность

### ✅ Масштабируемость
- Легко добавлять новые игры
- Единая система прогресса
- Гибкая архитектура категорий

### ✅ Гибкость
- Можно изменить настройки в любой момент
- Переопределение сложности для конкретной игры
- Управление активными категориями

### ✅ Аналитика
- Детальная статистика по всем направлениям
- Отслеживание прогресса во времени
- Выявление сильных и слабых сторон

---

## Roadmap реализации

### Этап 1: MVP (v1.0)
- ✅ Расширенный онбординг (имя + возраст + сложность)
- ✅ Адаптация кроссвордов по возрасту
- ✅ Система категорий для кроссвордов
- ✅ Трехуровневый прогресс
- ✅ LocalStorage для данных

### Этап 2: v1.1
- 🔄 Детальная статистика
- 🔄 Система достижений
- 🔄 Таблица лидеров
- 🔄 Google OAuth

### Этап 3: v2.0
- 📋 Добавление новых игр (Судоку, Анаграммы)
- 📋 Категории для новых игр
- 📋 Миграция на Supabase
- 📋 Социальные функции

---

**Дата создания:** 07.02.2026  
**Версия:** 1.0.0  
**Автор:** Sandro
